this is chapter3 with some modifications before creating chapter4